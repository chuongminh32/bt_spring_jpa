<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/admin}">
<head>
<title>Sửa User</title>
</head>
<body>
	<div layout:fragment="content" class="container mt-4">

		<h2>Cập nhật User</h2>

		<form th:action="@{/admin/user/update}" method="post"
			enctype="multipart/form-data" class="mt-3">

			<!-- Giữ id + avatar cũ -->
			<input type="hidden" name="id" th:value="${user.id}" /> <input
				type="hidden" name="oldAvatar" th:value="${user.avatar}" />

			<div class="mb-3">
				<label class="form-label">Email</label> <input type="text"
					name="email" class="form-control" th:value="${user.email}" required />
			</div>

			<div class="mb-3">
				<label class="form-label">Họ tên</label> <input type="text"
					name="fullName" class="form-control" th:value="${user.fullName}"
					required />
			</div>

			<div class="mb-3">
				<label class="form-label">Số điện thoại</label> <input type="text"
					name="phone" class="form-control" th:value="${user.phone}" />
			</div>

			<div class="mb-3">
				<label class="form-label">Mật khẩu</label> <input type="password"
					name="password" class="form-control" th:value="${user.password}"
					required />
			</div>

			<div class="mb-3">
				<label class="form-label">Quyền Admin</label> <select name="isAdmin"
					class="form-select">
					<option value="false" th:selected="${user.isAdmin == false}">No</option>
					<option value="true" th:selected="${user.isAdmin == true}">Yes</option>

				</select>
			</div>

			<!-- Avatar -->
			<div class="mb-3">
				<label class="form-label">Avatar hiện tại</label><br /> <img
					th:src="${user.avatar != null} ? @{/uploads/{img}(img=${user.avatar})} : @{/uploads/default-avatar.png}"
					alt="avatar" class="img-thumbnail mb-2"
					style="width: 100px; height: 100px; object-fit: cover;" />
			</div>

			<!-- Giữ id + avatar cũ -->
			<input type="hidden" name="id" th:value="${user.id}" /> <input
				type="hidden" name="oldAvatar" th:value="${user.avatar}" />

			<div class="mb-3">
				<label class="form-label">Đổi Avatar (nếu muốn)</label>
				<!-- tên phải khớp "avatarFile" -->
				<input type="file" name="avatarFile" class="form-control" />
			</div>


			<button type="submit" class="btn btn-success">Cập nhật</button>
			<a th:href="@{/admin/users}" class="btn btn-secondary">Quay lại</a>
		</form>

	</div>
</body>
</html>
