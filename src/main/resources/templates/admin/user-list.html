<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/admin}">
<head>
<title>Danh sÃ¡ch Users</title>
</head>
<body>
	<div layout:fragment="content" class="container mt-4">

		<h2 class="mb-3">Danh sÃ¡ch Users</h2>

		<!-- NÃºt thÃªm User + Thanh tÃ¬m kiáº¿m -->
		<div class="d-flex justify-content-between mb-3">
			<a th:href="@{/admin/user/add}" class="btn btn-primary">+ ThÃªm
				User</a> <input type="text" id="customSearch" class="form-control w-25"
				placeholder="ğŸ” Nháº­p tá»« khÃ³a Ä‘á»ƒ tÃ¬m...">
		</div>

		<!-- Báº£ng Users -->
		<table id="userTable"
			class="table table-bordered table-striped align-middle">
			<thead class="table-dark text-center">
				<tr>
					<th>ID</th>
					<th>Avatar</th>
					<th>Email</th>
					<th>Full Name</th>
					<th>Phone</th>
					<th>Admin</th>
					<th>Thao tÃ¡c</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="u : ${listUser}">
					<td class="text-center" th:text="${u.id}"></td>
					<td class="text-center"><img
						th:src="${u.avatar != null} ? @{/uploads/{img}(img=${u.avatar})} : @{/uploads/default-avatar.jpg}"
						alt="avatar" class="img-thumbnail"
						style="width: 60px; height: 60px; object-fit: cover;" /></td>
					<td th:text="${u.email}"></td>
					<td th:text="${u.fullName}"></td>
					<td th:text="${u.phone}"></td>
					<td class="text-center" th:text="${u.isAdmin}"></td>
					<td class="text-center">
						<!-- Sá»­a --> <a th:href="@{/admin/user/edit/{id}(id=${u.id})}"
						class="btn btn-sm btn-warning">Sá»­a</a> <!-- XÃ³a --> <a
						th:href="@{/admin/user/delete/{id}(id=${u.id})}"
						class="btn btn-sm btn-danger"
						onclick="return confirm('Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a user nÃ y?')">XÃ³a</a>

					</td>
				</tr>
			</tbody>
		</table>

	</div>

	<!-- CÃ¡c script sáº½ náº±m trong layout/admin.html Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng -->
	<script th:inline="javascript">
  $(document).ready(function () {
    let table = $('#userTable').DataTable({
      pageLength: 5,
      lengthChange: false,
      searching: true,   // báº­t Ä‘á»ƒ dÃ¹ng API search
      info: false,
      pagingType: "simple",
      dom: 't<"d-flex justify-content-center mt-3"p>',
      language: {
        paginate: {
          previous: "Â« TrÆ°á»›c",
          next: "Sau Â»"
        },
        zeroRecords: "KhÃ´ng cÃ³ dá»¯ liá»‡u"
      }
    });

    // ğŸ” Xá»­ lÃ½ tÃ¬m kiáº¿m thá»§ cÃ´ng
    $('#customSearch').on('keyup', function () {
      table.search(this.value).draw();
    });

    // ğŸ¨ Style pagination Ä‘áº¹p hÆ¡n
    function stylePagination() {
      $('.dataTables_paginate a')
        .addClass('btn btn-dark mx-2')
        .css({
          'color': '#fff',
          'text-decoration': 'none'
        });

      $('.dataTables_paginate .disabled a')
        .removeClass('btn-dark')
        .addClass('btn btn-secondary disabled')
        .css('color', '#fff');
    }

    stylePagination(); // cháº¡y láº§n Ä‘áº§u
    table.on('draw', function () {
      stylePagination();
    });
  });
</script>
</body>
</html>
